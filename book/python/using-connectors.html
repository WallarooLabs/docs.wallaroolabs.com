
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Using Connectors · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codetabs/codetabs.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="api.html" />
    
    
    <link rel="prev" href="interworker-serialization-and-resilience.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../what-is-wallaroo.html">
            
                <a href="../what-is-wallaroo.html">
            
                    
                    What is Wallaroo?
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Core Concepts</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../core-concepts/intro.html">
            
                <a href="../core-concepts/intro.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../core-concepts/core-concepts.html">
            
                <a href="../core-concepts/core-concepts.html">
            
                    
                    Introducing Wallaroo Core Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../core-concepts/state.html">
            
                <a href="../core-concepts/state.html">
            
                    
                    State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../core-concepts/working-with-state.html">
            
                <a href="../core-concepts/working-with-state.html">
            
                    
                    Working with State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../core-concepts/partitioning.html">
            
                <a href="../core-concepts/partitioning.html">
            
                    
                    Partitioning
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Wallaroo Language Support</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../language_support.html">
            
                <a href="../language_support.html">
            
                    
                    Wallaroo Languages Supported
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Wallaroo with Python</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="intro.html">
            
                <a href="intro.html">
            
                    
                    Wallaroo with Python Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../getting-started/setting-up-your-environment.html">
            
                <a href="../getting-started/setting-up-your-environment.html">
            
                    
                    Setting up Your Environment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../getting-started/choosing-an-installation-option.html">
            
                <a href="../getting-started/choosing-an-installation-option.html">
            
                    
                    Choosing an Installation Option
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../getting-started/installing-with-docker.html">
            
                <a href="../getting-started/installing-with-docker.html">
            
                    
                    Installing with Docker
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.2.1" data-path="../getting-started/docker-setup.html">
            
                <a href="../getting-started/docker-setup.html">
            
                    
                    Setting Up Your Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2.2" data-path="../getting-started/run-a-wallaroo-application-docker.html">
            
                <a href="../getting-started/run-a-wallaroo-application-docker.html">
            
                    
                    Run a Wallaroo Application in Docker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../getting-started/installing-with-vagrant.html">
            
                <a href="../getting-started/installing-with-vagrant.html">
            
                    
                    Installing with Vagrant
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.3.1" data-path="../getting-started/vagrant-setup.html">
            
                <a href="../getting-started/vagrant-setup.html">
            
                    
                    Setting Up Your Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3.2" data-path="../getting-started/run-a-wallaroo-application-vagrant.html">
            
                <a href="../getting-started/run-a-wallaroo-application-vagrant.html">
            
                    
                    Run a Wallaroo Application in Vagrant
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../getting-started/wallaroo-up.html">
            
                <a href="../getting-started/wallaroo-up.html">
            
                    
                    Installing with Wallaroo Up
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.4.1" data-path="../getting-started/run-a-wallaroo-application-wallaroo-up.html">
            
                <a href="../getting-started/run-a-wallaroo-application-wallaroo-up.html">
            
                    
                    Run a Wallaroo Application
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../getting-started/installing-from-source.html">
            
                <a href="../getting-started/installing-from-source.html">
            
                    
                    Installing From Source
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.5.1" data-path="../getting-started/setup.html">
            
                <a href="../getting-started/setup.html">
            
                    
                    Setting up Your Environment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.5.1.1" data-path="../getting-started/linux-setup.html">
            
                <a href="../getting-started/linux-setup.html">
            
                    
                    Ubuntu Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2.5.2" data-path="../getting-started/run-a-wallaroo-application.html">
            
                <a href="../getting-started/run-a-wallaroo-application.html">
            
                    
                    Run a Wallaroo Application
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2.6" data-path="../getting-started/starting-a-new-shell.html">
            
                <a href="../getting-started/starting-a-new-shell.html">
            
                    
                    Starting a new shell for Wallaroo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.7" data-path="../getting-started/conclusion.html">
            
                <a href="../getting-started/conclusion.html">
            
                    
                    Conclusion
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="wallaroo-python-api.html">
            
                <a href="wallaroo-python-api.html">
            
                    
                    Wallaroo Python API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="running-a-wallaroo-python-application.html">
            
                <a href="running-a-wallaroo-python-application.html">
            
                    
                    Running a Wallaroo Python Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="writing-your-own-application.html">
            
                <a href="writing-your-own-application.html">
            
                    
                    Writing Your Own Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="writing-your-own-stateful-application.html">
            
                <a href="writing-your-own-stateful-application.html">
            
                    
                    Writing Your Own Stateful Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.4" data-path="writing-your-own-partitioned-stateful-application.html">
            
                <a href="writing-your-own-partitioned-stateful-application.html">
            
                    
                    Writing Your Own Partitioned Stateful Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.5" data-path="word-count.html">
            
                <a href="word-count.html">
            
                    
                    Word Count
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.6" data-path="interworker-serialization-and-resilience.html">
            
                <a href="interworker-serialization-and-resilience.html">
            
                    
                    Interworker Serialization and Resilience
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.3.7" data-path="using-connectors.html">
            
                <a href="using-connectors.html">
            
                    
                    Using Connectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.8" data-path="api.html">
            
                <a href="api.html">
            
                    
                    Wallaroo Python API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" >
            
                <span>
            
                    
                    Debugging Python Wallaroo Applications
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.4.1" data-path="debugging.html">
            
                <a href="debugging.html">
            
                    
                    Debugging
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Wallaroo with Go</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../go/intro.html">
            
                <a href="../go/intro.html">
            
                    
                    Go API Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../go/getting-started/setting-up-your-environment.html">
            
                <a href="../go/getting-started/setting-up-your-environment.html">
            
                    
                    Setting up Your Environment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../go/getting-started/choosing-an-installation-option.html">
            
                <a href="../go/getting-started/choosing-an-installation-option.html">
            
                    
                    Choosing an Installation Option
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../go/getting-started/installing-with-docker.html">
            
                <a href="../go/getting-started/installing-with-docker.html">
            
                    
                    Installing with Docker
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.2.1" data-path="../go/getting-started/docker-setup.html">
            
                <a href="../go/getting-started/docker-setup.html">
            
                    
                    Setting Up Your Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2.2" data-path="../go/getting-started/run-a-wallaroo-go-application-docker.html">
            
                <a href="../go/getting-started/run-a-wallaroo-go-application-docker.html">
            
                    
                    Run a Wallaroo Application in Docker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.3" data-path="../go/getting-started/installing-with-vagrant.html">
            
                <a href="../go/getting-started/installing-with-vagrant.html">
            
                    
                    Installing with Vagrant
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.3.1" data-path="../go/getting-started/vagrant-setup.html">
            
                <a href="../go/getting-started/vagrant-setup.html">
            
                    
                    Setting Up Your Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.3.2" data-path="../go/getting-started/run-a-wallaroo-go-application-vagrant.html">
            
                <a href="../go/getting-started/run-a-wallaroo-go-application-vagrant.html">
            
                    
                    Run a Wallaroo Go Application in Vagrant
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.4" data-path="../go/getting-started/wallaroo-up.html">
            
                <a href="../go/getting-started/wallaroo-up.html">
            
                    
                    Installing with Wallaroo Up
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.4.1" data-path="../go/getting-started/run-a-wallaroo-go-application-wallaroo-up.html">
            
                <a href="../go/getting-started/run-a-wallaroo-go-application-wallaroo-up.html">
            
                    
                    Run a Wallaroo Go Application
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.5" data-path="../go/getting-started/installing-from-source.html">
            
                <a href="../go/getting-started/installing-from-source.html">
            
                    
                    Installing From Source
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.5.1" data-path="../go/getting-started/setup.html">
            
                <a href="../go/getting-started/setup.html">
            
                    
                    Setting up Your Environment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.5.1.1" data-path="../go/getting-started/linux-setup.html">
            
                <a href="../go/getting-started/linux-setup.html">
            
                    
                    Ubuntu Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.5.2" data-path="../go/getting-started/run-a-wallaroo-go-application.html">
            
                <a href="../go/getting-started/run-a-wallaroo-go-application.html">
            
                    
                    Run a Wallaroo Go Application
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.6" data-path="../go/getting-started/starting-a-new-shell.html">
            
                <a href="../go/getting-started/starting-a-new-shell.html">
            
                    
                    Starting a new shell for Wallaroo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7" data-path="../go/getting-started/conclusion.html">
            
                <a href="../go/getting-started/conclusion.html">
            
                    
                    Conclusion
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../go/api/wallaroo-go-api.html">
            
                <a href="../go/api/wallaroo-go-api.html">
            
                    
                    Wallaroo Go API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../go/api/writing-your-own-application.html">
            
                <a href="../go/api/writing-your-own-application.html">
            
                    
                    Writing Your Own Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.2" data-path="../go/api/writing-your-own-stateful-application.html">
            
                <a href="../go/api/writing-your-own-stateful-application.html">
            
                    
                    Writing Your Own Stateful Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.3" data-path="../go/api/word-count.html">
            
                <a href="../go/api/word-count.html">
            
                    
                    Word Count
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.4" data-path="../go/api/interworker-serialization-and-resilience.html">
            
                <a href="../go/api/interworker-serialization-and-resilience.html">
            
                    
                    Interworker Serialization and Resilience
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.5" data-path="../go/api/start-a-project.html">
            
                <a href="../go/api/start-a-project.html">
            
                    
                    Start A Go Project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.6" data-path="../go/api/api.html">
            
                <a href="../go/api/api.html">
            
                    
                    Wallaroo Go API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Running Wallaroo</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../running-wallaroo/running-wallaroo.html">
            
                <a href="../running-wallaroo/running-wallaroo.html">
            
                    
                    Running Wallaroo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../running-wallaroo/autoscale.html">
            
                <a href="../running-wallaroo/autoscale.html">
            
                    
                    Autoscale
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../running-wallaroo/resilience.html">
            
                <a href="../running-wallaroo/resilience.html">
            
                    
                    Resilience
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../running-wallaroo/wallaroo-command-line-options.html">
            
                <a href="../running-wallaroo/wallaroo-command-line-options.html">
            
                    
                    Command line options
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Appendix</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../appendix/virtualenv.html">
            
                <a href="../appendix/virtualenv.html">
            
                    
                    Wallaroo and Virtualenv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../appendix/tcp-decoders-and-encoders.html">
            
                <a href="../appendix/tcp-decoders-and-encoders.html">
            
                    
                    TCP Decoders and Encoders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../wallaroo-tools/giles-sender.html">
            
                <a href="../wallaroo-tools/giles-sender.html">
            
                    
                    Sending Data over TCP with Giles Sender
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="../wallaroo-tools/giles-receiver.html">
            
                <a href="../wallaroo-tools/giles-receiver.html">
            
                    
                    Receiving Data over TCP with Giles Receiver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="../metrics/metrics-ui.html">
            
                <a href="../metrics/metrics-ui.html">
            
                    
                    Monitoring Metrics with the Monitoring Hub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="../appendix/decoding-giles-receiver-output.html">
            
                <a href="../appendix/decoding-giles-receiver-output.html">
            
                    
                    Decoding Giles Receiver Output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="../appendix/wallaroo-and-long-running-data-processing-and-other-workflows.html">
            
                <a href="../appendix/wallaroo-and-long-running-data-processing-and-other-workflows.html">
            
                    
                    Wallaroo and Long-Running Data Processing and Other Workflows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.8" data-path="../appendix/wallaroo-in-docker-tips.html">
            
                <a href="../appendix/wallaroo-in-docker-tips.html">
            
                    
                    Tips for using Wallaroo in Docker
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Legal</li>
        
        
    

    
        
        <li class="header">* Terms and Conditions</li>
        
        
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Using Connectors</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="using-connectors-as-sources--sinks">Using Connectors as Sources &amp; Sinks</h1>
<p>This is a preview release of Wallaroo&apos;s connectors feature that allows full customization of sources and sinks. These sources and sinks can be integrated into Wallaroo using libraries you&apos;re already familiar with in Python. A number of built-in connectors offer a quick way to get started and hook up common stream types and they&apos;re all available for easy customization.</p>
<p>Care has been taken to keep the API simple and the runtime assumptions unobtrusive so it&apos;s easy to hook up the library to existing code. Read down below for more information on how this works. As this is still a preview release, we are looking for early feedback and would love to hear from you. You can connect with us by emailing <a href="mailto:hello@wallaroolabs.com" target="_blank">hello@wallaroolabs.com</a>.</p>
<p>Connectors are comprised of two parts. First is the entry in your application builder which explains how encoding and decoding of the content works as well as giving each connector instance a name and direction of flow (source or sink). Second is the script which is a local process which runs side-by-side with Wallaroo. We&apos;ll look at each part in turn in the sections below.</p>
<h2 id="using-a-connector-in-your-application">Using a Connector in Your Application</h2>
<p>In your application module&apos;s <code>application_setup</code> function, the application builder returns a description of your application in terms of pipelines. Connectors tap into this by allowing the declaration of source and sink connectors and wiring these up by name in your pipeline definitions.</p>
<p>Here is an example of what this looks like:</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">application_setup</span><span class="hljs-params">(args)</span>:</span>
    ab = wallaroo.ApplicationBuilder(<span class="hljs-string">&quot;Celsius to Fahrenheit&quot;</span>)

    ab.source_connector(<span class="hljs-string">&quot;celsius_feed&quot;</span>,
        encoder=encode_feed,
        decoder=decode_feed)

    ab.sink_connector(<span class="hljs-string">&quot;fahrenheit_conversion&quot;</span>,
        encoder=encode_conversion,
        decoder=decode_conversion)

    ab.new_pipeline(<span class="hljs-string">&quot;Celsius Conversion&quot;</span>, <span class="hljs-string">&quot;celsius_feed&quot;</span>)
    ab.to(multiply)
    ab.to(add)
    ab.to_sink(<span class="hljs-string">&quot;fahrenheit_conversion&quot;</span>)
    <span class="hljs-keyword">return</span> ab.build()
</code></pre>
<p>You can follow along in this example by going to <a href="https://github.com/WallarooLabs/wallaroo/tree//examples/python/celsius_connectors/" target="_blank">github</a>.</p>
<p>We have introduced two new application builder methods for declaring connectors: <code>source_connector</code> and <code>sink_connector</code>. These allow you to describe both ends of the connection so the connector script can encode or decode data in a way that&apos;s compatible with your application&apos;s worker code. Keeping these in one place helps ensure that it&apos;s easy to keep them in sync.</p>
<p>In this example we can look at the celsius feed&apos;s encoder and decoder functions:</p>
<pre><code class="lang-python"><span class="hljs-meta">@wallaroo.experimental.stream_message_encoder</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode_feed</span><span class="hljs-params">(data)</span>:</span>
    <span class="hljs-keyword">return</span> data

<span class="hljs-meta">@wallaroo.experimental.stream_message_decoder</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode_feed</span><span class="hljs-params">(data)</span>:</span>
    <span class="hljs-keyword">return</span> struct.unpack(<span class="hljs-string">&quot;&gt;f&quot;</span>, data)[<span class="hljs-number">0</span>]
</code></pre>
<p>Here we&apos;ve defined two functions and use <code>wallaroo.experimental.stream_message_encoder</code> and <code>wallaroo.experimental.stream_message_decoder</code> as decorators. These decorators will handle framing and delivery of your data, so all you need to ensure is that the bytes represent the single message you want to deliver.</p>
<p>You might ask why the example&apos;s encoder function definition is only returning the data. In this case, the example is receiving data that&apos;s already a packed floating point number so there is no need to reencode it. This allows the encoder to pass along data as-is when it&apos;s already in the correct format.</p>
<p>Returning to the application setup code, we should look at the pipeline definition to understand how all of this comes together. First is the <code>new_pipeline</code> call:</p>
<pre><code class="lang-python">ab.new_pipeline(<span class="hljs-string">&quot;Celsius Conversion&quot;</span>, <span class="hljs-string">&quot;celsius_feed&quot;</span>)
</code></pre>
<p>Instead of using something like the <code>wallaroo.TCPSourceConfig</code> instance that we might have used before (if not, we explain about how this works in the <a href="api.html#tcpsource">details</a> chapter) for a basic TCP source stream, we now use the name of the connector. This must match the type of connector; in this case, new_pipeline expects a source, so we should declare <code>&quot;celsius_feed&quot;</code> using <code>source_connector</code>.</p>
<p>Likewise, our sink has adopted a named connector:</p>
<pre><code class="lang-python">ab.to_sink(<span class="hljs-string">&quot;fahrenheit_conversion&quot;</span>)
</code></pre>
<p>This matches up with our call to <code>sink_connector</code> and it has its own encoder and decoder functions as well.</p>
<p>Notice how we don&apos;t couple the specifics of the medium used by the connector and instead focus on how we interpret incoming messages in terms of their serialization. This allows applications to evolve and mix their infrastructure over time.</p>
<h2 id="running-connector-scripts">Running Connector Scripts</h2>
<p>To run an application that makes use of these connectors we&apos;ll need to understand how the connector scripts work. Wallaroo includes a <a href="https://github.com/WallarooLabs/wallaroo/tree//connectors/" target="_blank">library of connectors</a> to help get you started. We&apos;ll look at <code>udp_source</code> and <code>udp_sink</code> as used in the example introduced above.</p>
<p>These included connectors are self-contained Python scripts. Some of them may expect a related Python library to be installed and available for import but our example uses the UDP facilities provided for by Python&apos;s standard library. Be sure that the Python path is set up to include the Wallaroo library.</p>
<p>If we run one of these scripts we&apos;ll see there are some required arguments listed. The first one should be familiar. <code>--application-module</code> is the same as the one seen when running a Wallaroo worker (you can review these command line parameters in the <a href="../running-wallaroo/running-wallaroo.html">Running Wallaroo</a> section). Providing this argument allows the script to autodetect most of the connector settings by reading the same application description that the Wallaroo application worker runs with.</p>
<p>The application module is not quite enough for the script to know what settings to use when connecting to Wallaroo. Since the application may have more than one connector, the <code>--connector</code> argument is required for disambiguating which connector in the application setup this script is running as. With this passed as an argument, we can autodetect the most common settings.</p>
<p>Many connector scripts will have their own additional arguments, some may be required and others may be optional. In this case we have two, the host and port. These argument names prefix the connector name to ensure that conflicting argument names do not cause problems. For example, you should be able to pass all your Wallaroo arguments in without conflict.</p>
<p>To illustrate this, let&apos;s look at what the <code>udp_source</code> command line parameters might look like:</p>
<pre><code class="lang-bash">./wallaroo/connectors/udp_source --application-module celsius \
    --connector celsius_feed \
    --celsius_feed-host 127.0.0.1 \
    --celsius_feed-port 6789
</code></pre>
<p>In this example, we are running a UDP source for our application which listens to a UDP socket on 127.0.0.1 port 6789 and forwards the data in each packet to Wallaroo as a message.</p>
<p>Since the included connector scripts are self-contained, feel free to copy it over to your application tree to use them directly and make path management a little easier.</p>
<h2 id="starting-with-prebuilt-connectors">Starting with Prebuilt Connectors</h2>
<p>We have a number of <a href="https://github.com/WallarooLabs/wallaroo/tree//connectors/" target="_blank">prebuilt connectors</a>. Here is a short description of each one. These are all written so they can be copied and customized in your application source tree. You&apos;re still welcome to run them in place as well.</p>
<h3 id="kafka">Kafka</h3>
<p>This connector provides Kafka source and sink support. This uses the <a href="https://pypi.org/project/kafka/" target="_blank">kafka library</a>. Consumer group based sources are supported to allow easier management of your source&apos;s progress through a topic.</p>
<p>While Wallaroo already has built-in Kafka support, using the connector allows you to support the use of consumer groups and reuse any logic you might already have around offset management and consumer lifecycles. We&apos;re looking for feedback, so if your Kafka use case doesn&apos;t seem to fit either option, please let us know at <a href="mailto:hello@wallaroolabs.com" target="_blank">hello@wallaroolabs.com</a>.</p>
<h3 id="aws-kinesis">AWS Kinesis</h3>
<p>AWS Kinesis is supported via the <a href="https://pypi.org/project/boto3/" target="_blank">boto3 library</a>. This script will expect AWS credentials to be setup as described in their documentation.</p>
<h3 id="redis">Redis</h3>
<p>Redis has many ways to be used as a source and a sink. We&apos;ve provided two starting points to show how a source and sink can work. The script is very easy to modify and uses the well maintained <a href="https://pypi.org/project/redis/" target="_blank">redis library</a>.</p>
<p>For the source, we show an example using the subscription support offered by Redis pubsub and it&apos;s a natural fit for many stream processing applications. Check out <code>redis_subscriber_source</code> for <a href="https://github.com/WallarooLabs/wallaroo/tree//connectors/redis_subscriber_source" target="_blank">details</a>.</p>
<p>For the sink, we show that not everything needs to look exactly like a stream to be used with Wallaroo. We use the given hash key in redis and set key-value pairs on that target hash for each key-value pair passed to the sink. This is very handy for those cases that want to keep track of the latest value. See <code>redis_hash_sink</code> for <a href="https://github.com/WallarooLabs/wallaroo/tree//connectors/redis_hash_sink" target="_blank">details</a>.</p>
<h3 id="rabbitmq">RabbitMQ</h3>
<p>Our RabbitMQ source uses the <a href="https://pypi.org/project/pika/" target="_blank">pika library</a>. We support automatic provisioning of missing queues in our setup code but it&apos;s advised that users ensure they provision their broker&apos;s exchange with the appropriate type beforehand.</p>
<h3 id="udp">UDP</h3>
<p>Our UDP support uses the Python standard library. To see an example of it in action, check out the <a href="https://github.com/Wallaroo/wallaroo/tree//examples/python/celsius_connectors/" target="_blank">celsius_connectors example</a>.</p>
<h3 id="aws-s3">AWS S3</h3>
<p>This sink is powered by the <a href="https://pypi.org/project/boto3/" target="_blank">boto3 library</a> and allows key value pairs to be uploaded as named blobs to an S3 bucket.</p>
<h3 id="postgres">Postgres</h3>
<p>We offer some starting templates for Postgres integration. These depend on your database schema and so we&apos;ve left them in the <a href="https://github.com/WallarooLabs/wallaroo/tree//connectors/templates" target="_blank">connectors/templates directory</a>.</p>
<p>As a source we have a very interesting example of how notifiers can turn a regular table into a stream. If you&apos;re struggling with finding an efficient way to stream relational data, this might be a good place to start.</p>
<p>On the sink side, we support inserting new records for each sink output. This should be easy to modify to allow more complex database interactions.</p>
<p>If you have a use-case with Postgres and don&apos;t feel like our template addresses it. Please let us know at <a href="mailto:hello@wallaroolabs.com" target="_blank">hello@wallaroolabs.com</a>.</p>
<h2 id="building-your-own-connectors">Building Your Own Connectors</h2>
<p>While we offer prebuilt connectors and they can be modified, sometimes you might find yourself needing to build a connector from scratch. We&apos;ll walk through a source and sink example.</p>
<h3 id="custom-source-connector">Custom Source Connector</h3>
<p>To build a new source, you need to import <code>wallaroo.experimental</code> along with any other runtime requirements you have. Because this is a vanilla Python runtime, you&apos;re welcome to organize your code however you like.</p>
<p>When your script starts running, you need to create the proper
connector instance type. In this case we&apos;d like to build a source connector so we&apos;ll use this:</p>
<pre><code class="lang-python">connector = wallaroo.experimental.SourceConnector(required_params=[], optional_params=[])
</code></pre>
<p>For this connector we&apos;re not requesting any additional parameters but if we did, it&apos;d be available on the <code>connector.params</code> property.</p>
<p>Once we&apos;ve constructed this and we&apos;re ready to connect to Wallaroo to allow data to flow we call <code>connect</code>:</p>
<pre><code class="lang-python">connector.connect()
</code></pre>
<p>We can pass custom <code>host</code> and <code>port</code> parameters here if the automatically resolved information needs to change. Since we recommend that you run your connector scripts next to the Wallaroo process, the defaults work just fine.</p>
<p>Your script can do any other initialization but once it&apos;s running, all you need is a call to <code>write</code>:</p>
<pre><code class="lang-python">connector.write(<span class="hljs-string">&quot;hello world&quot;</span>)
</code></pre>
<p>In this case, the string hello world will be passed to the encoder function specified in the application module. The resulting bytes will then be sent to the local Wallaroo worker and then decoded with the specified decoder function.</p>
<h3 id="custom-sink-connector">Custom Sink Connector</h3>
<p>Building a sink is very similar to a source except that we listen for connections from Wallaroo rather than connect to Wallaroo.</p>
<p>To get started we build an instance of the sink connector:</p>
<pre><code class="lang-python">connector = wallaroo.experimental.SinkConnector(required_params=[], optional_params=[])
</code></pre>
<p>Once you&apos;re ready to accept incoming data you can call <code>listen</code>:</p>
<pre><code class="lang-python">connector.listen()
</code></pre>
<p>When you&apos;re ready to read a value, call the <code>read</code> method. Usually this can be done in a loop like so:</p>
<pre><code class="lang-python"><span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    author, message = connector.read()
    print(<span class="hljs-string">&quot;{} said {}&quot;</span>.format(author, message))
</code></pre>
<p>In this loop we do one read at a time and expect a tuple to be returned by the decoder function that is automatically called for us (as specified in the application_setup for the application).</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="interworker-serialization-and-resilience.html" class="navigation navigation-prev " aria-label="Previous page: Interworker Serialization and Resilience">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="api.html" class="navigation navigation-next " aria-label="Next page: Wallaroo Python API">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Using Connectors","level":"4.3.7","depth":2,"next":{"title":"Wallaroo Python API","level":"4.3.8","depth":2,"path":"book/python/api.md","ref":"book/python/api.md","articles":[]},"previous":{"title":"Interworker Serialization and Resilience","level":"4.3.6","depth":2,"path":"book/python/interworker-serialization-and-resilience.md","ref":"book/python/interworker-serialization-and-resilience.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["highlight","footnote-string-to-number","ga","codetabs"],"pluginsConfig":{"search":{},"codetabs":{},"footnote-string-to-number":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"ga":{"configuration":"auto","token":"UA-59652249-3"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"intro.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"footerTemplate":"©2017 All Rights Reserved, Wallaroo Labs"},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"book/python/using-connectors.md","mtime":"2018-09-28T04:18:45.979Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-09-28T04:18:52.576Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-codetabs/codetabs.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

